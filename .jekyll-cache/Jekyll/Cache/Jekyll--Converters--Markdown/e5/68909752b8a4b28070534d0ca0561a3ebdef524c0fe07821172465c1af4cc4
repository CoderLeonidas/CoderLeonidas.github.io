I"‹9<blockquote>
  <p>KSCrashï¼šä¸€ä¸ªç»ˆæçš„iOS crash reporter</p>
</blockquote>

<h1 id="ä¸ºä½•ä½¿ç”¨kscrash">ä¸ºä½•ä½¿ç”¨KSCrashï¼Ÿ</h1>

<p>å› ä¸ºåœ¨ç°æœ‰çš„ä¸€äº›crash reporteræŠ¥å‘Šå´©æºƒæ—¶ï¼ŒKSCrashè¿˜èƒ½æ¯”å®ƒä»¬è¿˜èƒ½åšå¾—æ›´å¤šã€‚ä»¥ä¸‹æ˜¯KSCrashçš„ä¸€äº›å…³é”®å±æ€§ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>1. æ”¯æŒç¦»çº¿é‡æ–°ç¬¦å·åŒ–çš„è®¾å¤‡ä¸Šç¬¦å·åŒ–(åœ¨iOSç‰ˆæœ¬ä¸­ï¼Œè®¸å¤šåŠŸèƒ½å·²ç»è¢«ä¿®æ”¹)ã€‚
2. ç”Ÿæˆå®Œå…¨çš„è‹¹æœæŠ¥å‘Šï¼Œæ¯ä¸ªå­—æ®µéƒ½ä¸è½ä¸‹
3. æ”¯æŒ32æˆ–64ä½ 
4. èƒ½å¤„ç†åªèƒ½åœ¨machçº§åˆ«æ•è·çš„é”™è¯¯ï¼Œæ¯”å¦‚å †æ ˆæº¢å‡ºã€‚
5. è·Ÿè¸ªç”±äºæœªæ•è·çš„c++å¼‚å¸¸å¯¼è‡´çš„REALã€‚
6. åœ¨crashè‡ªå·±çš„å›è°ƒé‡Œå¤„ç†crash(æˆ–è€…åœ¨ç”¨æˆ·çš„crashå›è°ƒé‡Œ)
7. æ£€æµ‹åƒµå°¸(é‡Šæ”¾)å¯¹è±¡è®¿é—®å°è¯•
8. åœ¨åƒµå°¸æˆ–å†…å­˜æŸåçš„æƒ…å†µä¸‹æ¢å¤ä¸¢å¤±çš„NSExceptionæ¶ˆæ¯
9. åœ¨å¯„å­˜å™¨å’Œå †æ ˆä¸Šè‡ªçœå¯¹è±¡(Cå­—ç¬¦ä¸²å’ŒObjective-Cå¯¹è±¡ï¼ŒåŒ…æ‹¬ivars)ã€‚
10. æå–å…³äºå¼‚å¸¸å¼•ç”¨çš„å¯¹è±¡çš„ä¿¡æ¯(ä¾‹å¦‚"unrecognized selector sent to instance 0xa26d9a0")
11. å®ƒçš„å¯æ’å…¥æœåŠ¡æŠ¥å‘Šä½“ç³»ç»“æ„ä½¿å…¶æ˜“äºé€‚åº”ä»»ä½•APIæœåŠ¡ã€‚
12. è½¬å‚¨å †æ ˆå†…å®¹ã€‚
13. è¯Šæ–­crashåŸå› (CrashåŒ»ç”Ÿ)
14. ä»¥JSONæ ¼å¼è®°å½•è‹¹æœå´©æºƒæŠ¥å‘Šæ‰€ä¸èƒ½è®°å½•çš„å¤§é‡ä¿¡æ¯ã€‚
15. æ”¯æŒåŒ…æ‹¬ç¨‹åºå‘˜æä¾›çš„é¢å¤–æ•°æ®(å´©æºƒå‰å’Œå´©æºƒæœŸé—´)
</pre></td></tr></tbody></table></code></pre></div></div>
<h1 id="kscrashæ”¯æŒå¤„ç†ä»¥ä¸‹ç±»å‹çš„crash">KSCrashæ”¯æŒå¤„ç†ä»¥ä¸‹ç±»å‹çš„crash:</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>mach å†…æ ¸å¼‚å¸¸
è‡´å‘½ä¿¡å·(Fatal signals)
C++ å¼‚å¸¸
OCå¼‚å¸¸
ä¸»çº¿ç¨‹æ­»é”
è‡ªå®šä¹‰crash(æ¯”å¦‚æ¥è‡ªè„šæœ¬è¯­è¨€çš„è‡ªå®šä¹‰crash)
</pre></td></tr></tbody></table></code></pre></div></div>
<p>#KSCrashå¯ä»¥å‘ä»¥ä¸‹æœåŠ¡å™¨æŠ¥å¯¼ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>Hockey
QuincyKit
Victory
Email
</pre></td></tr></tbody></table></code></pre></div></div>

<p>#æ–°ç‰¹æ€§ï¼š</p>

<p>C++å¼‚å¸¸å¤„ç†ï¼š
æ˜¯çš„ï¼Œé€šå¸¸ä½ çš„appç”±äºæœªæ•è·çš„C++å¼‚å¸¸è€Œç»ˆæ­¢ï¼Œä½ ä¼šçœ‹åˆ°è¿™æ ·çš„å †æ ˆï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libsystem_kernel.dylib          0x9750ea6a 0x974fa000 + 84586 (__pthread_kill + 10)
1   libsystem_sim_c.dylib           0x04d56578 0x4d0f000 + 292216 (abort + 137)
2   libc++abi.dylib                 0x04ed6f78 0x4ed4000 + 12152 (abort_message + 102)
3   libc++abi.dylib                 0x04ed4a20 0x4ed4000 + 2592 (_ZL17default_terminatev + 29)
4   libobjc.A.dylib                 0x013110d0 0x130b000 + 24784 (_ZL15_objc_terminatev + 109)
5   libc++abi.dylib                 0x04ed4a60 0x4ed4000 + 2656 (_ZL19safe_handler_callerPFvvE + 8)
6   libc++abi.dylib                 0x04ed4ac8 0x4ed4000 + 2760 (_ZSt9terminatev + 18)
7   libc++abi.dylib                 0x04ed5c48 0x4ed4000 + 7240 (__cxa_rethrow + 77)
8   libobjc.A.dylib                 0x01310fb8 0x130b000 + 24504 (objc_exception_rethrow + 42)
9   CoreFoundation                  0x01f2af98 0x1ef9000 + 204696 (CFRunLoopRunSpecific + 360)
...
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ ¹æœ¬æ²¡æ³•è·Ÿè¸ªè¿™ä¸ªå¼‚å¸¸æ˜¯å•¥å’Œåœ¨å“ªæŠ›å‡ºçš„ï¼
ç°åœ¨æœ‰äº†KSCrashï¼Œä½ å¯ä»¥ä»ä¸‹é¢ä¿¡æ¯è·å¾—æœªæ•è·çš„å¼‚å¸¸ç±»å‹ã€æè¿°ã€å’Œå®ƒæŠ›å‡ºçš„åœ°æ–¹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>Application Specific Information:
*** Terminating app due to uncaught exception 'MyException', reason: 'Something bad happened...'

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   Crash-Tester                    0x0000ad80 0x1000 + 40320 (-[Crasher throwUncaughtCPPException] + 0)
1   Crash-Tester                    0x0000842e 0x1000 + 29742 (__32-[AppDelegate(UI) crashCommands]_block_invoke343 + 78)
2   Crash-Tester                    0x00009523 0x1000 + 34083 (-[CommandEntry executeWithViewController:] + 67)
3   Crash-Tester                    0x00009c0a 0x1000 + 35850 (-[CommandTVC tableView:didSelectRowAtIndexPath:] + 154)
4   UIKit                           0x0016f285 0xb4000 + 766597 (-[UITableView _selectRowAtIndexPath:animated:scrollPosition:notifyDelegate:] + 1194)
5   UIKit                           0x0016f4ed 0xb4000 + 767213 (-[UITableView _userSelectRowAtPendingSelectionIndexPath:] + 201)
6   Foundation                      0x00b795b3 0xb6e000 + 46515 (__NSFireDelayedPerform + 380)
7   CoreFoundation                  0x01f45376 0x1efa000 + 308086 (__CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + 22)
8   CoreFoundation                  0x01f44e06 0x1efa000 + 306694 (__CFRunLoopDoTimer + 534)
9   CoreFoundation                  0x01f2ca82 0x1efa000 + 207490 (__CFRunLoopRun + 1810)
10  CoreFoundation                  0x01f2bf44 0x1efa000 + 204612 (CFRunLoopRunSpecific + 276)
...
</pre></td></tr></tbody></table></code></pre></div></div>

<p>#æ–¹ä¾¿çš„C++å¼€å‘åŠ©æ‰‹
å¦‚æœä½ æ‰“å¼€è·Ÿè¸ªæ‰“å°ï¼š
`
[KSCrash sharedInstance].printTraceToStdout = YES;
`
å®ƒä¼šåœ¨ä½ çš„appæŠ›å‡ºæœªæ•è·C++å¼‚å¸¸çš„æ—¶å€™æ‰“å°ä¸€ä¸ªåˆé€‚çš„å †æ ˆè·Ÿè¸ªä¿¡æ¯åˆ°æ ‡å‡†è¾“å‡º(stdout)ä¸Šï¼å¦åˆ™è°ƒè¯•å™¨åªä¼šå°†ä½ å¼•å‘é‡æ–°æŠ›å‡ºå¼‚å¸¸çš„ä½ç½®ã€‚</p>

<p>#è‡ªå®šä¹‰Crashå’Œå †æ ˆè·Ÿè¸ª
ä½ ç°åœ¨å¯ä»¥æŠ¥å¯¼ä½ è‡ªå·±è‡ªå®šä¹‰çš„crashå’Œå †æ ˆè·Ÿè¸ªä¿¡æ¯(æƒ³ä¸€ä¸‹è„šæœ¬è¯­è¨€)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>- (void) reportUserException:(NSString*) name
reason:(NSString*) reason
lineOfCode:(NSString*) lineOfCode
stackTrace:(NSArray*) stackTrace
terminateProgram:(BOOL) terminateProgram;
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¯¦æƒ…è§KSCrash.hæ–‡ä»¶ã€‚</p>

<p>#ä¸ç¨³å®šçš„ç‰¹æ€§
ä¸‹åˆ—ç‰¹æ€§è¢«è®¤ä¸ºæ˜¯â€ä¸ç¨³å®šâ€çš„ï¼Œå¹¶ä¸”é»˜è®¤ç¦ç”¨ï¼š
æ­»é”æ£€æµ‹</p>

<p>#ä¸å…¼å®¹APIæ›´æ”¹é€šçŸ¥
ä»2013å¹´1æœˆ29æ—¥èµ·ï¼Œæˆ‘ä¿®æ”¹äº†KSCrashä¸»APIï¼Œä½¿ç”¨å±æ€§è€Œä¸æ˜¯åˆå§‹åŒ–æ–¹æ³•å‚æ•°è¿›è¡Œé…ç½®ã€‚æœ‰äº†æ‰€æœ‰çš„æ–°é€‰æ‹©åï¼Œäº‹æƒ…å¼€å§‹å˜å¾—æœ‰ç‚¹æ£˜æ‰‹ã€‚è¿™åº”è¯¥æ˜¯æœ€åä¸€ä¸ªä¸»è¦çš„APIæ›´æ”¹ã€‚</p>

<p>æ³¨æ„:åˆå§‹åŒ–KSCrashçš„é¦–é€‰æ–¹æ³•ç°åœ¨æ˜¯é€šè¿‡å®‰è£…å¯¹è±¡ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨è¿‡æ»¤å™¨ã€‚è¯¦è§â€œå¦‚ä½•ä½¿ç”¨KSCrashâ€ã€‚</p>

<p>#å¦‚ä½•build KSCrash</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>1 é€‰ä¸­KSCrashçš„scheme
2 é€‰æ‹©iOSè®¾å¤‡
3 Productsèœå•é‡Œé€‰æ‹©Archive
</pre></td></tr></tbody></table></code></pre></div></div>
<p>å½“buildå®Œæˆï¼Œä¼šåœ¨Finderçœ‹åˆ°frameworkï¼Œä½ å¯ä»¥åƒä½¿ç”¨ä»»ä½•å…¶ä»–frameworkä¸€æ ·ä½¿ç”¨å®ƒã€‚</p>

<p>#å¦‚ä½•ä½¿ç”¨KSCrash
1 æ·»åŠ è¿™ä¸ªframeworkåˆ°ä½ çš„å·¥ç¨‹(æˆ–è€…æ·»åŠ KSCrashå·¥ç¨‹è¿›æ¥ï¼Œä½œä¸ºä¾èµ–é¡¹)
2 æ·»åŠ ä¸‹åˆ—ç³»ç»Ÿframeworkå’Œlibåˆ°ä½ çš„å·¥ç¨‹</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>libc++.dylib
libz.dylib
MessageUI.framework (iOS only)
SystemConfiguration.framework
</pre></td></tr></tbody></table></code></pre></div></div>

<p>3 åœ¨Build Settingæ˜¯çš„Other Linker Flagsé‡Œæ·»åŠ â€-Objcâ€æ ‡è¯†
4 æ·»åŠ ä¸‹åˆ—å†…å®¹åˆ°ä½ app delegateçš„ <code class="highlighter-rouge">[application: didFinishLaunchingWithOptions:] </code>æ–¹æ³•é‡Œï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre></td><td class="rouge-code"><pre>#import &lt;KSCrash/KSCrash.h&gt;
// Include to use the standard reporter.
#import &lt;KSCrash/KSCrashInstallationStandard.h&gt;
// Include to use Quincy or Hockey.
#import &lt;KSCrash/KSCrashInstallationQuincyHockey.h&gt;
// Include to use the email reporter.
#import &lt;KSCrash/KSCrashInstallationEmail.h&gt;
// Include to use Victory.
#import &lt;KSCrash/KSCrashInstallationVictory.h&gt;

- (BOOL)application:(UIApplication*) application didFinishLaunchingWithOptions:(NSDictionary*) launchOptions
{
KSCrashInstallationStandard* installation = [KSCrashInstallationStandard sharedInstance];
installation.url = [NSURL URLWithString:@"http://put.your.url.here"];

// OR:

KSCrashInstallationQuincy* installation = [KSCrashInstallationQuincy sharedInstance];
installation.url = [NSURL URLWithString:@"http://put.your.url.here"];

// OR:

KSCrashInstallationHockey* installation = [KSCrashInstallationHockey sharedInstance];
installation.appIdentifier = @"PUT_YOUR_HOCKEY_APP_ID_HERE";

// OR:

KSCrashInstallationEmail* installation = [KSCrashInstallationEmail sharedInstance];
installation.recipients = @[@"some@email.address"];

// Optional (Email): Send Apple-style reports instead of JSON
[installation setReportStyle:KSCrashEmailReportStyleApple useDefaultFilenameFormat:YES]; 

// Optional: Add an alert confirmation (recommended for email installation)
[installation addConditionalAlertWithTitle:@"Crash Detected"
message:@"The app crashed last time it was launched. Send a crash report?"
yesAnswer:@"Sure!"
noAnswer:@"No thanks"];

// OR:

KSCrashInstallationVictory* installation = [KSCrashInstallationVictory sharedInstance];
installation.url = [NSURL URLWithString:@"https://put.your.url.here/api/v1/crash/&lt;application key&gt;"];

[installation install];
â€¦
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¿™å°†å®‰è£…å´©æºƒå“¨å…µç³»ç»Ÿ(å¯ä»¥æ‹¦æˆªcrasheså¹¶å°†æŠ¥å‘Šå­˜å­˜ç›˜)ã€‚ä¸è¿‡æ³¨æ„ï¼Œä½ è¿˜å¯ä»¥ä¸ºå„ç§å®‰è£…è®¾ç½®å…¶ä»–ä½ æƒ³è¦çš„å…¶ä»–å±æ€§ã€‚
ä¸€æ—¦ä½ å‡†å¤‡å‘é€ä»»ä½•çš„crashæŠ¥å‘Šï¼Œè°ƒç”¨å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>[installation sendAllReportsWithCompletion:^(NSArray *filteredReports, BOOL completed, NSError *error)
{
// Stuff to do when report sending is complete
}];
</pre></td></tr></tbody></table></code></pre></div></div>

<p>#æ¨èé˜…è¯»
å¦‚æœå¯ä»¥çš„è¯ï¼Œä½ åº”è¯¥é˜…è¯»ä¸‹åˆ—å¤´æ–‡ä»¶æ¥å®Œå…¨ç†è§£KSCrashæ‰€æ‹¥æœ‰çš„ç‰¹æ€§å’Œå¦‚ä½•ä½¿ç”¨å®ƒï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>KSCrash.h
KSCrashInstallation.h
KSCrashInstallation(SPECIFIC TYPE).h
Architecture.md
</pre></td></tr></tbody></table></code></pre></div></div>

<p>#é«˜ç«¯ç”¨æ³•</p>

<p>##å…è®¸è®¾å¤‡å†…ç½®ç¬¦å·åŒ–
##å…è®¸é«˜çº§åŠŸèƒ½
KSCrashå…·æœ‰ä¸€äº›åœ¨ä¸€ç‰‡èŒ«ç„¶ä¸­æ£€æŸ¥å´©æºƒæŠ¥å‘Šæ—¶éå¸¸æœ‰ç”¨çš„é«˜çº§åŠŸèƒ½ã€‚å…¶ä¸­ä¸€äº›æ¶‰åŠåˆ°è¾ƒå°çš„æƒè¡¡ï¼Œå› æ­¤å¤§å¤šæ•°é»˜è®¤æƒ…å†µä¸‹æ˜¯ç¦ç”¨çš„ã€‚
###è‡ªå®šä¹‰ç”¨æˆ·æ•°æ®(KSCrash.hä¸­çš„userInfo)
è®¾ç½®userInfoå±æ€§åï¼Œä½ å¯ä»¥å°†è‡ªå®šä¹‰ç”¨æˆ·æ•°æ®å­˜å‚¨åˆ°ä¸‹ä¸€æ¬¡çš„crash reportä¸Š
###åƒµå°¸å¯¹è±¡è·Ÿè¸ª(KSCrash.hä¸­çš„zombieCacheSize)
KSCrashå…·æœ‰æ£€æµ‹åƒµå°¸å¯¹è±¡(æŒ‡å‘å·²é‡Šæ”¾å¯¹è±¡çš„æ‚¬åœæŒ‡é’ˆ)çš„èƒ½åŠ›ã€‚å®ƒé€šè¿‡è®°å½•å·²é‡Šæ”¾å¯¹è±¡çš„ç±»å‹å’Œåœ°å€æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å®ƒå°†è¿™äº›å€¼å­˜å‚¨åœ¨ç¼“å­˜ä¸­ï¼Œå¹¶åˆ‡æ–­å·²é‡Šæ”¾å¯¹è±¡çš„åœ°å€ã€‚è¿™æ„å‘³ç€ï¼Œè®¾ç½®ç¼“å­˜çš„å¤§å°è¶Šå°ï¼Œå“ˆå¸Œå†²çªå‘ç”Ÿçš„å‡ ç‡è¶Šå¤§ã€‚å¹¶ä¸”ä½ å°†å› æ­¤å¤±å»å…ˆå‰å·²é‡Šæ”¾å¯¹è±¡çš„ä¿¡æ¯ã€‚</p>

<p>å¯ç”¨åƒµå°¸è·Ÿè¸ªåï¼ŒKSCrashè¿˜å°†æ£€æµ‹ä¸¢å¤±çš„NSExceptionå¹¶æ‰“å°å…¶å†…å®¹ã€‚æŸäº›ç±»å‹çš„å†…å­˜æŸåæˆ–å †æ ˆæŸåå´©æºƒå¯èƒ½ä¼šå¯¼è‡´å¼‚å¸¸æå‰é‡Šæ”¾ï¼Œä»è€Œè¿›ä¸€æ­¥å½±å“è°ƒè¯•åº”ç”¨ç¨‹åºçš„å·¥ä½œï¼Œå› æ­¤è¯¥ç‰¹æ€§æœ‰æ—¶éå¸¸æ–¹ä¾¿ã€‚</p>

<p>æƒè¡¡ï¼šåƒµå°¸è·Ÿè¸ªçš„ä»£ä»·æ˜¯å‘å¯¹è±¡é‡Šæ”¾ä½ç½®æ·»åŠ éå¸¸å°çš„å¼€é”€ï¼Œå¹¶ä¿ç•™ä¸€äº›å†…å­˜ã€‚</p>

<p>###æ­»é”æ£€æµ‹(KSCrash.hä¸­çš„deadlockWatchdogInterval)
<em>ä¸¥æ­£è­¦å‘Šï¼ï¼æœ¬åŠŸèƒ½æ˜¯ä¸ç¨³å®šçš„ï¼å®ƒä¼šå‘ˆç°å‡é˜³æ€§å¹¶ä½¿ä½ çš„appå´©æºƒï¼</em>
###å†…å­˜è‡ªçœ(KSCrash.hä¸­çš„introspectMemory)
å½“åº”ç”¨ç¨‹åºå´©æºƒæ—¶ï¼Œå†…å­˜ä¸­é€šå¸¸æ®‹ç•™æœ‰è¢«æ ˆã€å¯„å­˜å™¨ç”šè‡³å¼‚å¸¸æ¶ˆæ¯å¼•ç”¨çš„å¯¹è±¡å’Œå­—ç¬¦ä¸²ã€‚å½“å¯ç”¨æ­¤åŠŸèƒ½æ—¶ï¼ŒKSCrashå°†å†…çœè¿™äº›å†…å­˜åŒºåŸŸå¹¶å°†å®ƒä»¬çš„å†…å®¹å­˜å‚¨åˆ°crash reportä¸­ã€‚</p>

<p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®doNotIntrospectClasseså±æ€§ï¼ŒæŒ‡å®šä¸€ä¸ªç±»çš„åˆ—è¡¨ï¼Œæ¥é¿å…è¿™äº›ç±»çš„è‡ªçœã€‚
###è‡ªå®šä¹‰crashå¤„ç†ä»£ç (KSCrash.hä¸­çš„onCrash)</p>

<p>å¦‚æœä½ æƒ³åœ¨crashå‘ç”Ÿæ—¶åšä¸€äº›é¢å¤–æ“ä½œ(æ¯”å¦‚æ·»åŠ æ›´å¤šçš„ä¸Šä¸‹æ–‡æ•°æ®ä¿¡æ¯åˆ°æŠ¥å‘Šä¸­å»)ï¼Œä½ å¯ä»¥è¿™ä¹ˆåšã€‚</p>

<p>ç„¶è€Œï¼Œä½ å¿…é¡»ç¡®ä¿ä½ åªä½¿ç”¨å¼‚æ­¥å®‰å…¨çš„ä»£ç ã€‚å¹¶ä¸”æœ€é‡è¦çš„æ˜¯ï¼Œä¸è¦é‚£ä¸ªæ–¹æ³•é‡Œè°ƒç”¨OCä»£ç ï¼åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä½ éƒ½å¯ä»¥è¿™æ ·åšï¼Œä½†æ˜¯åœ¨æŸäº›ç‰¹å®šçš„å´©æºƒç±»ä¸­ï¼Œæ— è§†æ­¤è­¦å‘Šçš„å¤„ç†ç¨‹åºä»£ç å°†å¯¼è‡´å´©æºƒå¤„ç†ç¨‹åºå´©æºƒ! æ³¨æ„ï¼Œå¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼ŒKSCrashå°†æ£€æµ‹å®ƒå¹¶ç¼–å†™å®Œæ•´çš„æŠ¥å‘Šï¼Œå°½ç®¡æ‚¨çš„è‡ªå®šä¹‰å¤„ç†ç¨‹åºä»£ç å¯èƒ½æ²¡æœ‰å®Œå…¨è¿è¡Œï¼</p>

<p>æƒè¡¡ï¼š ä½ å¿…é¡»å°å¿ƒä½ æ‰€æ”¾å…¥çš„è‡ªå®šä¹‰å´©æºƒå¤„ç†ä»£ç ï¼</p>

<p>###KSCrash æ—¥å¿—é‡å®šå‘</p>

<p>è¿™ä¼šå°†KSCrashå°†è¦æ‰“å°åˆ°æ§åˆ¶å°çš„å†…å®¹ï¼Œå†™åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚æˆ‘é€šå¸¸ç”¨è¿™ä¸ªåŠŸèƒ½æ¥è°ƒè¯•KSCrashè‡ªèº«ï¼Œä½†å®ƒä¹Ÿå¯ä»¥æ‹æ´¾å¾ˆå¤šå…¶ä»–ç”¨åœºï¼Œæ‰€ä»¥æˆ‘å…¬å¼€ä¸ºå®ƒå…¬å¼€äº†ä¸€ä¸ªAPIï¼</p>

<p>#ä¾‹å­
workspaceä¸­åŒ…å«äº†å‡ ä¸ªä¾‹å­appï¼Œç”¨æ¥æ¼”ç¤ºå¸¸è§çš„KSCrashç”¨æ³•ã€‚è¯·çœ‹ä¸‹æ¯ä¸ªAppDelegate.mæ–‡ä»¶çš„é¡¶éƒ¨ä¿¡æ¯æ¥äº†è§£å®ƒåšäº†ä»€ä¹ˆã€‚</p>

<p>åŸé“¾æ¥: https://github.com/kstenerud/KSCrash</p>

:ET