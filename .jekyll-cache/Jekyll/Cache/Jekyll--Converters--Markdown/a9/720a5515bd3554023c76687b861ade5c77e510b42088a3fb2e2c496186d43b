I"ÖN<blockquote>
  <p>Masonryä»¥æ›´æ¼‚äº®çš„è¯­æ³•å°è£…äº†AutoLayoutï¼Œæ˜¯ä¸€ä¸ªè½»é‡çº§çš„å¸ƒå±€æ¡†æ¶ã€‚
Masonryæœ‰è‡ªå·±çš„å¸ƒå±€DSL(domain-specific language)ï¼Œæä¾›äº†ä¸€ç§é“¾å¼å†™æ³•æ¥æè¿°NSLayoutConstraintsï¼Œè¿™ä½¿å¾—å¸ƒå±€ä»£ç å˜å¾—æ›´åŠ ç®€æ´å’Œå¯è¯»ã€‚
Masonry æ”¯æŒ iOS å’Œ macOSã€‚</p>
</blockquote>

<hr />
<h1 id="nslayoutconstraintsæ€ä¹ˆäº†">NSLayoutConstraintsæ€ä¹ˆäº†ï¼Ÿ</h1>
<p>åœ¨åº•å±‚AutoLayoutæ˜¯ä¸€ç§å¾ˆå¼ºå¤§çµæ´»çš„ç”¨äºç®¡ç†å’Œå¸ƒå±€è§†å›¾çš„æ–¹å¼ã€‚ä½†ç”¨ä»£ç åˆ›å»ºçº¦æŸ(Constraints)æ˜¾å¾—éå¸¸å†—é•¿ä¸”ä¸æ˜“æè¿°ã€‚è®¾æƒ³è¿™æ ·çš„ç®€å•åœºæ™¯ï¼šåœ¨çˆ¶è§†å›¾ä¸­å¡«æ”¾ä¸€ä¸ªå­è§†å›¾ï¼Œä¸”æ¯ä¸€è¾¹ç•™ä¸‹10åƒç´ çš„è¾¹è·ã€‚</p>

<p>UIView *superview = self.view;</p>

<p>UIView *view1 = [[UIView alloc] init];
view1.translatesAutoresizingMaskIntoConstraints = NO;
view1.backgroundColor = [UIColor greenColor];
[superview addSubview:view1];</p>

<p>UIEdgeInsets padding = UIEdgeInsetsMake(10, 10, 10, 10);
[superview addConstraints:@[
//view1 constraints
[NSLayoutConstraint constraintWithItem:view1
attribute:NSLayoutAttributeTop
relatedBy:NSLayoutRelationEqual
toItem:superview
attribute:NSLayoutAttributeTop
multiplier:1.0
constant:padding.top],</p>

<p>[NSLayoutConstraint constraintWithItem:view1
attribute:NSLayoutAttributeLeft
relatedBy:NSLayoutRelationEqual
toItem:superview
attribute:NSLayoutAttributeLeft
multiplier:1.0
constant:padding.left],</p>

<p>[NSLayoutConstraint constraintWithItem:view1
attribute:NSLayoutAttributeBottom
relatedBy:NSLayoutRelationEqual
toItem:superview
attribute:NSLayoutAttributeBottom
multiplier:1.0
constant:-padding.bottom],</p>

<p>[NSLayoutConstraint constraintWithItem:view1
attribute:NSLayoutAttributeRight
relatedBy:NSLayoutRelationEqual
toItem:superview
attribute:NSLayoutAttributeRight
multiplier:1
constant:-padding.right],</p>

<p>]];</p>

<p>å³ä½¿è¿™æ ·ç®€å•çš„ä¸€ä¸ªä¾‹å­ï¼Œä»£ç å°±å˜å¾—è¿™ä¹ˆå†—é•¿ï¼Œå¦‚æœå†å¤šä¸¤ä¸‰ä¸ªè§†å›¾ï¼Œå°±ç«‹åˆ»å˜å¾—å¯è¯»æ€§å¾ˆå·®ã€‚
å¦å¤–ä¸€ä¸ªé€‰æ‹©æ˜¯ä½¿ç”¨VFLï¼Œç¨å¾®ä¸é‚£ä¹ˆé•¿å’Œç»•ã€‚ä½†æ˜¯ASKIIç±»å‹çš„è¯­æ³•æœ‰å®ƒè‡ªå·±çš„éšæ‚£ï¼Œå¹¶ä¸”åŠ¨ç”»å¾ˆéº»çƒ¦å› ä¸º<em>NSLayoutConstraint constraintsWithVisualFormat:</em>è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</p>

<hr />
<h1 id="å‡†å¤‡å¥½è§ä½ çš„maker">å‡†å¤‡å¥½è§ä½ çš„Makerï¼</h1>

<p>ä»¥ä¸‹æ˜¯ç”¨<strong>MASConstraintMaker</strong>åˆ›å»ºçš„ç®€å•çº¦æŸï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>
UIEdgeInsets padding = UIEdgeInsetsMake(10, 10, 10, 10);

[view1 mas_makeConstraints:^(MASConstraintMaker *make) {
make.top.equalTo(superview.mas_top).with.offset(padding.top);
//with is an optional semantic filler
make.left.equalTo(superview.mas_left).with.offset(padding.left);
make.bottom.equalTo(superview.mas_bottom).with.offset(-padding.bottom);
make.right.equalTo(superview.mas_right).with.offset(-padding.right);
}];
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¿˜å¯ä»¥æ›´çŸ­ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>[view1 mas_makeConstraints:^(MASConstraintMaker *make) {
make.edges.equalTo(superview).with.insets(padding);
}];
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¸è¿‡éœ€è¦æ³¨æ„åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­æˆ‘ä»¬éœ€è¦æŠŠçº¦æŸæ·»åŠ åˆ°superviewä¸­ï¼Œå°½ç®¡Masonryä¼šè‡ªåŠ¨æ·»åŠ çº¦æŸåˆ°åˆé€‚çš„viewä¸­ã€‚
Masonryä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>view1.translatesAutoresizidngMaskIntoConstraints = NO;
</pre></td></tr></tbody></table></code></pre></div></div>
<hr />
<h1 id="ä¸æ˜¯æ‰€æœ‰çš„äº‹æƒ…éƒ½æ˜¯å¹³ç­‰çš„">ä¸æ˜¯æ‰€æœ‰çš„äº‹æƒ…éƒ½æ˜¯å¹³ç­‰çš„</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>.equalTo ç­‰ä»·äº NSLayoutRelationEqual
.lessThanOrEqualTo ç­‰ä»·äº NSLayoutRelationLessThanOrEqual
.greaterThanOrEqualTo ç­‰ä»·äº NSLayoutRelationGreaterThanOrEqual
</pre></td></tr></tbody></table></code></pre></div></div>
<p>è¿™3ä¸ªç­‰ä»·å…³ç³»æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥æ˜¯ä¸‹é¢çš„ä»»ä½•ä¸€ç§ï¼š</p>
<h2 id="1masviewattribute">1ã€MASViewAttribute</h2>

<p>make.centerX.lessThanOrEqualTo(view2.mas_left);
ä»¥ä¸‹æ˜¯MASViewAttributeå’ŒNSLayoutAttribute çš„å¯¹åº”å…³ç³»ï¼š</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">MASViewAttribute</th>
      <th style="text-align: center">NSLayoutAttribute</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">view.mas_left</td>
      <td style="text-align: center">NSLayoutAttributeLeft</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_right</td>
      <td style="text-align: center">NSLayoutAttributeRight</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_top</td>
      <td style="text-align: center">NSLayoutAttributeTop</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_bottom</td>
      <td style="text-align: center">NSLayoutAttributeBottom</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_leading</td>
      <td style="text-align: center">NSLayoutAttributeLeading</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_trailing</td>
      <td style="text-align: center">NSLayoutAttributeTrailing</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_width</td>
      <td style="text-align: center">NSLayoutAttributeWidth</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_height</td>
      <td style="text-align: center">NSLayoutAttributeHeight</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_centerX</td>
      <td style="text-align: center">NSLayoutAttributeCenterX</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_centerY</td>
      <td style="text-align: center">NSLayoutAttributeCenterY</td>
    </tr>
    <tr>
      <td style="text-align: center">view.mas_baseline</td>
      <td style="text-align: center">NSLayoutAttributeBaseline</td>
    </tr>
  </tbody>
</table>

<h2 id="2-uiviewnsview">2. UIView/NSView</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>if you want view.left to be greater than or equal to label.left :
//è¿™2ä¸­çº¦æŸæ˜¯ç­‰ä»·çš„
make.left.greaterThanOrEqualTo(label);
make.left.greaterThanOrEqualTo(label.mas_left);
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="3-nsnumber">3. NSNumber</h2>
<p>Auto Layoutå…è®¸å®½å’Œé«˜è®¾ç½®ä¸ºå¸¸é‡ã€‚å¦‚æœæƒ³è®¾ç½®viewçš„æœ€å°å’Œæœ€å¤§å®½åº¦ï¼Œå¯ä»¥ä¼ ä¸€ä¸ªnumberå€¼:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>//width &gt;= 200 &amp;&amp; width &lt;= 400
make.width.greaterThanOrEqualTo(@200);
make.width.lessThanOrEqualTo(@400);
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ç„¶è€ŒAuto Layout ä¸å…è®¸left, right, centerYç­‰çš„å¯¹é½å±æ€§è®¾ç½®æˆå¸¸é‡å€¼ã€‚æ‰€ä»¥ï¼Œç»™è¿™äº›å±æ€§ä¼ NSNumberï¼ŒMasonryä¼šè½¬æ¢åˆ°viewçš„superviewä¸­å»ï¼Œæ¯”å¦‚ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>//creates view.left = view.superview.left + 10
make.left.lessThanOrEqualTo(@10)
</pre></td></tr></tbody></table></code></pre></div></div>

<p>é™¤äº†NSNumberï¼Œä¹Ÿå¯ä»¥ç”¨åŸå§‹å€¼æˆ–ç»“æ„ä½“æ¥å»ºç«‹çº¦æŸï¼Œå¦‚ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>make.top.mas_equalTo(42);
make.height.mas_equalTo(20);
make.size.mas_equalTo(CGSizeMake(50, 100));
make.edges.mas_equalTo(UIEdgeInsetsMake(10, 0, 10, 0));
make.left.mas_equalTo(view).mas_offset(UIEdgeInsetsMake(10, 0, 10, 0));
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¸€èˆ¬æ”¯æŒ<em>è‡ªåŠ¨è£…ç®±(autoboxing)</em>çš„å®ä¼šæœ‰mas_å‰ç¼€ã€‚æ²¡å‰ç¼€çš„ç‰ˆæœ¬åœ¨å¯¼å…¥Masronryå‰ï¼Œé€šè¿‡å®šä¹‰<strong>MAS_SHORTHAND_GLOBALS</strong>ï¼Œä¹Ÿæ˜¯å¯ä»¥ç”¨çš„ã€‚</p>

<h2 id="4-nsarray">4. NSArray</h2>
<p>åŒ…å«å‰é¢ä»»ä½•ç±»å‹å…ƒç´ çš„æ•°ç»„ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>make.height.equalTo(@[view1.mas_height, view2.mas_height]);
make.height.equalTo(@[view1, view2]);
make.left.equalTo(@[view1, @100, view3.right]);
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />
<p>#è€ƒè™‘ä¼˜å…ˆçº§ï¼ˆprioritizeï¼‰</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>.priority å…è®¸ä½ æŒ‡å®šä¸€ä¸ªç¡®å®šçš„ä¼˜å…ˆçº§
.priorityHigh ç­‰ä»·äº UILayoutPriorityDefaultHigh
.priorityMedium ä»‹äºé«˜ä¼˜å…ˆçº§å’Œä½ä¼˜å…ˆçº§ä¹‹é—´
.priorityLow ç­‰ä»·äºUILayoutPriorityDefaultLow
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ä¼˜å…ˆçº§å¯ä»¥æ·»åŠ åœ¨çº¦æŸé“¾åé¢ï¼Œåƒè¿™æ ·:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>make.left.greaterThanOrEqualTo(label.mas_left).with.priorityLow();
make.top.equalTo(label.mas_top).with.priority(600);
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />
<p>#ç»“æ„ï¼Œç»“æ„ï¼Œç»“æ„
Masonryä¹Ÿæä¾›äº†ä¸€äº›ç®€ä¾¿æ–¹æ³•æ¥åŒæ—¶åˆ›å»ºå¤šç§çº¦æŸã€‚è¿™äº›è¢«ç§°ä¸º<strong>MASCompositeConstraints</strong></p>

<h3 id="edges">edges</h3>
<p>// make top, left, bottom, right equal view2</p>

<p>make.edges.equalTo(view2);</p>

<p>// make top = superview.top + 5, left = superview.left + 10,
//      bottom = superview.bottom - 15, right = superview.right - 20</p>

<p>make.edges.equalTo(superview).insets(UIEdgeInsetsMake(5, 10, 15, 20))</p>

<h3 id="size">size</h3>
<p>// make width and height greater than or equal to titleLabel</p>

<p>make.size.greaterThanOrEqualTo(titleLabel)</p>

<p>// make width = superview.width + 100, height = superview.height - 50</p>

<p>make.size.equalTo(superview).sizeOffset(CGSizeMake(100, -50))</p>

<h3 id="center">center</h3>
<p>// make centerX and centerY = button1</p>

<p>make.center.equalTo(button1)</p>

<p>// make centerX = superview.centerX - 5, centerY = superview.centerY + 10</p>

<p>make.center.equalTo(superview).centerOffset(CGPointMake(-5, 10))</p>

<p>ä¸ºäº†å¯è¯»æ€§é«˜ä¹Ÿå¯ä»¥æŠŠå±æ€§è¿èµ·æ¥åƒè¿™æ ·:</p>

<p>// All edges but the top should equal those of the superview</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>make.left.right.and.bottom.equalTo(superview);
make.top.equalTo(otherView);
</pre></td></tr></tbody></table></code></pre></div></div>
<hr />
<p>#è®©ç¾å¥½æŒç»­å‘ç”Ÿ</p>

<p>æœ‰æ—¶ä½ éœ€è¦ä¿®æ”¹å·²å­˜åœ¨çš„çº¦æŸæ¥æ”¯æŒåŠ¨ç”»æˆ–è€…ç§»é™¤ã€æ›¿æ¢çº¦æŸã€‚åœ¨Masonryä¸­æœ‰ä¸€äº›ä¸åŒçš„æ–¹å¼æ¥æ›´æ–°çº¦æŸã€‚</p>

<h2 id="1å¼•ç”¨">1ã€å¼•ç”¨</h2>
<p>å¯ä»¥é€šè¿‡åˆ›å»ºå˜é‡æˆ–è€…å±æ€§æ¥å¼•ç”¨ä¸€ä¸ªç‰¹å®šçš„çº¦æŸã€‚ä¹Ÿå¯ä»¥é€šè¿‡æ•°ç»„ä¿å­˜çš„æ–¹å¼æ¥å¼•ç”¨å¤šä¸ªçº¦æŸã€‚</p>

<p>// in public/private interface</p>

<p>@property (nonatomic, strong) MASConstraint *topConstraint;</p>

<p>â€¦</p>

<p>// when making constraints</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>[view1 mas_makeConstraints:^(MASConstraintMaker *make) {
self.topConstraint = make.top.equalTo(superview.mas_top).with.offset(padding.top);
make.left.equalTo(superview.mas_left).with.offset(padding.left);
}];

...
</pre></td></tr></tbody></table></code></pre></div></div>
<p>// ç„¶åä½ å¯ä»¥è°ƒç”¨</p>

<p>[self.topConstraint uninstall];</p>

<h2 id="2-mas_updateconstraints">2. mas_updateConstraints</h2>
<p>å¦‚æœåªæ˜¯æ›´æ–°çº¦æŸä¸­çš„å¸¸é‡å€¼ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ª<strong>mas_updateConstraints</strong>æ–¹æ³•æ¥ä»£æ›¿mas_makeConstraints
// è¿™æ˜¯è‹¹æœæ¨èçš„ç”¨æ¥æ·»åŠ æˆ–æ›´æ–°çº¦æŸçš„åœ°æ–¹
// è¿™ä¸ªæ–¹æ³•ä¼šåœ¨å“åº”setNeedsUpdateConstraintsæ—¶è¢«å¤šæ¬¡è°ƒç”¨
// ä¼šè¢«UIKitå†…éƒ¨æˆ–è€…åœ¨ä½ çš„ä»£ç ä¸­å½“ä½ éœ€è¦è§¦å‘çº¦æŸçš„æ›´æ–°æ—¶è°ƒç”¨</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>- (void)updateConstraints {
[self.growingButton mas_updateConstraints:^(MASConstraintMaker *make) {
make.center.equalTo(self);
make.width.equalTo(@(self.buttonSize.width)).priorityLow();
make.height.equalTo(@(self.buttonSize.height)).priorityLow();
make.width.lessThanOrEqualTo(self);
make.height.lessThanOrEqualTo(self);
}];

//according to apple super should be called at end of method
[super updateConstraints];
}
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="3mas_remakeconstraints">3ã€mas_remakeConstraints</h2>
<p><em>mas_updateConstraints</em>åœ¨æ›´æ–°ä¸€ç»„çº¦æŸæ—¶å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯åšä¸€äº›æ›´æ–°çº¦æŸå€¼ä¹‹å¤–çš„äº‹å°±æ˜¾å¾—åŠ›ä¸ä»å¿ƒäº†ã€‚è¿™å°±æ˜¯ä¸ºä½•è¦å¼•å…¥<strong>mas_remakeConstraints</strong>ã€‚</p>

<p><strong>mas_remakeConstraints</strong>ç±»ä¼¼mas_updateConstraintsï¼Œä½†æ˜¯ä¸åŒäºæ›´æ–°å¸¸é‡å€¼ï¼Œå®ƒä¼šåœ¨é‡æ–°å®‰è£…çº¦æŸå‰ç§»é™¤æ‰€æœ‰çš„çº¦æŸã€‚è¿™å°±è®©ä½ èƒ½æä¾›ä¸åŒçš„çº¦æŸï¼Œè€Œä¸ç”¨æ—¶åˆ»è®°ä½ä½ è¦ç§»é™¤å“ªä¸ªçº¦æŸäº†ã€‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>- (void)changeButtonPosition {
[self.button mas_remakeConstraints:^(MASConstraintMaker *make) {
make.size.equalTo(self.buttonSize);

if (topLeft) {
make.top.and.left.offset(10);
} else {
make.bottom.and.right.offset(-10);
}
}];
}
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />
<p>#å‡ºç°éº»çƒ¦å’‹æ•´ï¼
å¸ƒå±€å¹¶ä¸èƒ½åƒä½ æ„æ–™çš„é‚£æ ·ï¼Œæ‰€ä»¥å½“äº‹æƒ…çœŸçš„æç ¸äº†çš„æ—¶å€™ï¼Œä½ è‚¯å®šä¸å¸Œæœ›åœ¨æ§åˆ¶å°çœ‹åˆ°è¿™æ ·çš„è¾“å‡ºï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>Unable to simultaneously satisfy constraints.....blah blah blah....
(
"&lt;NSLayoutConstraint:0x7189ac0 V:[UILabel:0x7186980(&gt;=5000)]&gt;",
"&lt;NSAutoresizingMaskLayoutConstraint:0x839ea20 h=--&amp; v=--&amp; V:[MASExampleDebuggingView:0x7186560(416)]&gt;",
"&lt;NSLayoutConstraint:0x7189c70 UILabel:0x7186980.bottom == MASExampleDebuggingView:0x7186560.bottom - 10&gt;",
"&lt;NSLayoutConstraint:0x7189560 V:|-(1)-[UILabel:0x7186980]   (Names: '|':MASExampleDebuggingView:0x7186560 )&gt;"
)

Will attempt to recover by breaking constraint
&lt;NSLayoutConstraint:0x7189ac0 V:[UILabel:0x7186980(&gt;=5000)]&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Masonryåœ¨NSLayoutConstraintå¢åŠ äº†ä¸€ä¸ªåˆ†ç±»ï¼Œè¦†ç›–äº†<em>- (NSString *)description</em>çš„é»˜è®¤å®ç°ã€‚è¿™æ ·åœ¨ç»™çº¦æŸå’Œviewèµ·åå­—åï¼Œèƒ½å¤Ÿå¾ˆè½»æ¾çš„ä»ä¸­æ‰¾å‡ºå“ªäº›æ˜¯Masonryåˆ›å»ºçš„çº¦æŸã€‚</p>

<p>è¿™æ„å‘³ç€ä½ çš„æ§åˆ¶å°è¾“å‡ºçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>Unable to simultaneously satisfy constraints......blah blah blah....
(
"&lt;NSAutoresizingMaskLayoutConstraint:0x8887740 MASExampleDebuggingView:superview.height == 416&gt;",
"&lt;MASLayoutConstraint:ConstantConstraint UILabel:messageLabel.height &gt;= 5000&gt;",
"&lt;MASLayoutConstraint:BottomConstraint UILabel:messageLabel.bottom == MASExampleDebuggingView:superview.bottom - 10&gt;",
"&lt;MASLayoutConstraint:ConflictingConstraint[0] UILabel:messageLabel.top == MASExampleDebuggingView:superview.top + 1&gt;"
)

Will attempt to recover by breaking constraint
&lt;MASLayoutConstraint:ConstantConstraint UILabel:messageLabel.height &gt;= 5000&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />
<p>#åº”è¯¥åœ¨å“ªåˆ›å»ºçº¦æŸï¼Ÿ</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre>@implementation DIYCustomView

- (id)init {
self = [super init];
if (!self) return nil;

// --- Create your views here ---
self.button = [[UIButton alloc] init];

return self;
}

// å‘Šè¯‰UIKitä½ åœ¨ä½¿ç”¨AutoLayout
+ (BOOL)requiresConstraintBasedLayout {
return YES;
}

// è¿™æ˜¯è‹¹æœæ¨èç”¨æ¥æ·»åŠ æˆ–æ›´æ–°çº¦æŸçš„åœ°æ–¹
- (void)updateConstraints {

// åœ¨è¿™é‡Œæ›´æ–°æˆ–è€…æ·»åŠ çº¦æŸ
[self.button remakeConstraints:^(MASConstraintMaker *make) {
make.width.equalTo(@(self.buttonSize.width));
make.height.equalTo(@(self.buttonSize.height));
}];

//æ ¹æ®è‹¹æœä»‹ç»superæ–¹æ³•åº”è¯¥åœ¨æ–¹æ³•çš„æœ€åè°ƒç”¨ä¸€ä¸‹
[super updateConstraints];
}

- (void)didTapButton:(UIButton *)button {
// --- Do your changes ie change variables that affect your layout etc ---
self.buttonSize = CGSize(200, 200);

// é€šçŸ¥çº¦æŸä»–ä»¬åº”è¯¥è¢«æ›´æ–°äº†
[self setNeedsUpdateConstraints];
}

@end
</pre></td></tr></tbody></table></code></pre></div></div>
<hr />
<p>#å®‰è£…ï¼š
ä½¿ç”¨CocoaPods.
åœ¨Podfileæ–‡ä»¶ä¸­å†™ï¼š</p>

<p>pod â€˜Masonryâ€™<br />
å³å¯ã€‚</p>

<p>å¦‚æœä½ åœ¨ç”¨Masonryæ—¶ä¸æƒ³è§åˆ°è®¨åŒçš„mas_å‰ç¼€ï¼Œå°±æ·»åŠ </p>

<p>#define MAS_SHORTHAND
åˆ°prefix.pchï¼Œå¹¶å¯¼å…¥åˆ°Masonryä¸­ã€‚</p>

<hr />
<p>#ä¾¿æ·ä»£ç å—
å°†ä»¥ä¸‹ä»£ç å—æ‹·è´åˆ°~/Library/Developer/Xcode/UserData/CodeSnippetsï¼Œå†™Masonryä»£ç çˆ½åˆ°é£èµ·ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>mas_make -&gt; [&lt;view&gt; mas_makeConstraints:^(MASConstraintMaker *make){&lt;code&gt;}];
mas_update -&gt; [&lt;view&gt; mas_updateConstraints:^(MASConstraintMaker *make){&lt;code&gt;}];
mas_remake -&gt; [&lt;view&gt; mas_remakeConstraints:^(MASConstraintMaker *make){&lt;code&gt;}];
</pre></td></tr></tbody></table></code></pre></div></div>
<hr />
<p>#ç‰¹æ€§ï¼š</p>

<p>1ã€ä¸åªæ˜¯Auto Layoutçš„å­é›†ï¼Œä»»ä½•NSLayoutConstraintèƒ½åšçš„ï¼ŒMasonryéƒ½èƒ½åš
2ã€å¾ˆæ£’çš„debugæ”¯æŒï¼Œåªè¦ä½ ç»™çº¦æŸå’Œviewå–å¥½æœ‰æ„ä¹‰çš„åå­—
3ã€çº¦æŸè¯»èµ·æ¥åƒè‡ªç„¶è¯­å¥ï¼Œé€šä¿—æ˜“æ‡‚
4ã€æ²¡æœ‰ä»¤äººæŠ“ç‹‚çš„å®é­”æ³•ã€‚Masonryæœ‰äº†å®ä¸ä¼šæ±¡æŸ“å…¨å±€çš„åå­—ç©ºé—´ã€‚
5ã€ä¸åŸºäºå­—ç¬¦ä¸²å’Œå­—å…¸ï¼Œæ‰€ä»¥ç¼–è¯‘çš„æ—¶å€™å°±èƒ½æ£€æŸ¥å‡ºé—®é¢˜ã€‚</p>

:ET