# 窗口编程指南

应用程序在屏幕上显示必须管理和协调的窗口。一个窗口对象最多对应一个屏幕上的窗口。窗口的两个主要功能是提供放置视图的区域，以及接受和分发用户通过鼠标和键盘操作发送的事件。术语窗口有时指应用程序工具包对象，有时指窗口服务器的窗口设备;什么意思在上下文中是明确的。面板是一种特殊类型的窗口，通常在应用程序中充当辅助功能，例如实用程序窗口。

本文档面向需要在应用程序中使用窗口和面板的Cocoa开发人员。


##  文档结构

本编程主题描述如何使用窗口和面板。

这些文章为您提供了关于不同类型窗口及其工作方式的基本信息：

- 窗口如何工作

- 窗口如何显示

- 模态窗口如何工作

- 面板Panel如何工作

- 窗口控制器如何工作
 
- 窗口分层与窗口类型
 
- 窗口图层与级别
 
- 设置窗口集合行为
 
 这些文章介绍如何使用窗口：
 
- 打开和关闭窗口

- 调整窗口大小与放置窗口

- 保存窗口位置数据到User’s Defaults

- 最小化窗口

- 使用窗口菜单

 这些文章描述如何改变窗口外观
 
- 设置窗口外观

- 设置窗口的标题和代表的文件( Represented File)

- 设置窗口图像的属性

这些文章描述如何处理窗口事件
 
- 在窗口中处理事件

- 在窗口中使用键盘界面控件

- 使用窗口的字段编辑器

这些文章描述了一些窗口的高级特性：

- 使用窗口的通知和代理方法

- 窗口图片的拖放

- 在窗口中更新鼠标图片

- 缓存窗口图片

----
##  窗口如何工作

NSWindow类定义了管理和协调应用程序在屏幕上显示的窗口的对象。一个单独的NSWindow对象最多对应一个屏幕窗口。NSWindow对象的两个主要功能是提供放置NSView对象的区域，并接受用户通过鼠标和键盘的操作向适当的视图分发事件。注意，术语窗口有时指应用程序工具包对象，有时指窗口服务器的显示设备;什么意思在上下文中是明确的。AppKit还定义了NSWindow的一个抽象子类- NSPanel，它为辅助窗口添加了更合适的行为。


一个NSWindow对象是由一个框架矩形定义的，它包围了整个窗口，包括它的标题栏、边框和其他外围元素(如调整大小控件)，而一个内容矩形只包围了它的内容区域。这两个矩形都在屏幕坐标系统中指定，并且仅限于整数值。框架矩形建立了窗口的基本坐标系统。

通常，您使用Interface Builder创建窗口，这允许您定位它们、设置它们的许多属性并布局它们的视图。你对窗口所做的程序性工作通常包括打开和关闭屏幕;改变窗口标题等动态属性;运行模式窗口来限制用户输入;以及分配一个可以监视窗口的某些操作(如关闭、缩放和调整大小)的委托。

您还可以通过指定窗口内容矩形的大小和位置等属性，使用其中的初始化器以编程方式创建窗口。框架（frame）矩形是由内容矩形的尺寸派生出来的。

创建时，窗口将自动创建两个视图:
- 填充框架矩形并绘制边框的不透明框架视图、标题栏、其他外围元素和背景
- 填充内容矩形的透明内容视图。

框架视图及其外围元素是应用程序无法直接访问的私有对象。内容视图是窗口中可访问的最高视图;您可以使用`setContentView`:方法将默认内容视图替换为您自己创建的视图。窗口决定内容视图的位置;你不能使用以`setFrame`开头的NSView方法来定位它;您必须使用NSWindow类的放置方法，如打开和关闭窗口中所述。

您可以通过NSView 的`addSubview`:方法将其他视图作为内容视图的子视图或任何内容视图的子视图，等等，添加到窗口。这个视图树称为窗口的视图层次结构。当一个窗口被告知显示它自己时，它通过发送`display`…发送到其视图层次结构中的顶级视图的消息。因为显示是按照一定的顺序进行的，所以content视图(首先绘制的视图)可能会被它的子视图完全或部分地隐藏，而这些子视图可能会被它们的子视图(等等)所隐藏。


##  窗口如何显示

显示一个NSWindow对象从它的视图对象执行的绘图开始，这些对象积累在窗口的显示缓冲区中或立即显示在屏幕上。与NSView对象一样，窗口可以被无条件地显示，也可以仅仅标记为需要显示，分别使用`display`和`setViewsNeedDisplay`:方法。`displayIfNeeded`消息只在标记为需要显示时才显示窗口的视图。通常，每当一个视图被标记为需要显示时，窗口都会注意到这个事实，并在不久后自动显示自己。这种自动显示通常在每次通过**事件循环**时执行，但是可以使用`setAutodisplay`:方法关闭它。如果您关闭了一个窗口的自动显示，那么您将负责在任何需要的时候显示它。

窗口的视图可以同时绘制。您可以使用`allowsConcurrentViewDrawing`和`setAllowsConcurrentViewDrawing`方法来分别确定和设置一个窗口是否并发地绘制它的视图。默认情况下，窗口的视图是并发绘制的。

在每次通过事件循环时，应用程序对象(application object)调用其`updateWindows`方法，该方法向每个窗口发送更新消息。NSWindow的子类可以覆盖此方法来检查应用程序的状态，并相应地更改它们自己的状态或外观- 例如根据选择的对象来启用或禁用菜单、按钮和其他控件。

除了在屏幕上显示自身之外，窗口还可以打印自身的全部内容，就像视图一样。`print`:方法会运行应用程序的打印面板，并使窗口的框架视图打印自身。`dataWithEPSInsideRect`方法有类似的行为。有关更多信息，请参阅[Printing Programming Guide for Mac.]()。


## 模态窗口如何工作

## 面板Panel如何工作

## 窗口控制器如何工作

## 窗口分层与窗口类型

## 窗口图层与级别
 
## 设置窗口集合行为

## 打开和关闭窗口

## 调整窗口大小与放置窗口

## 保存窗口位置数据到User’s Defaults

## 最小化窗口

## 使用窗口菜单

 
## 设置窗口外观

## 设置窗口的标题和代表的文件( Represented File)

## 设置窗口图像的属性

## 在窗口中处理事件

## 在窗口中使用键盘界面控件

## 使用窗口的字段编辑器



## 使用窗口的通知和代理方法

## 窗口图片的拖放

## 在窗口中更新鼠标图片

## 缓存窗口图片

## 还可以看看



## 参考文章

[Window Programming Guide](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/WinPanel/Introduction.html#//apple_ref/doc/uid/10000031-SW1)


